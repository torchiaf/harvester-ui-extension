{"version":3,"file":"harvester-1.0.0.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-1.0.0/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-1.0.0/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    },\n    close: {\n      type:     Function,\n      required: true\n    },\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return {\n      checkedList: [],\n      checkAll:    true\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter((volume) => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      let goTo;\n\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...this.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((_results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          this.value?.[0]?.currentRouter().push(goTo);\n        }\n        this.close();\n      }).catch((err) => {\n        this.$emit('errors', err);\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    {{ t('promptRemove.attemptingToRemove', {type}) }}\n    <span v-clean-html=\"resourceNames(names, plusMore, t)\"></span>\n\n    <div class=\"mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.title') }}\n    </div>\n    <div v-if=\"value.length === 1\">\n      <span\n        v-for=\"(name, i) in removeNameArr[value[0].id]\"\n        :key=\"i\"\n      >\n        <label class=\"checkbox-container mr-15\"><input\n                                                  v-model=\"checkedList\"\n                                                  type=\"checkbox\"\n                                                  :label=\"name\"\n                                                  :value=\"name\"\n                                                />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ name }}\n        </label>\n      </span>\n    </div>\n\n    <div v-else>\n      <label class=\"checkbox-container mr-15\"><input\n                                                v-model=\"checkAll\"\n                                                type=\"checkbox\"\n                                              />\n        <span\n          class=\"checkbox-custom mr-5\"\n          role=\"checkbox\"\n        />\n        {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n      </label>\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=32e98488\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","role","_createElementBlock","_hoisted_1","_ctx","t","type","$props","$options","resourceNames","names","plusMore","_hoisted_2","_toDisplayString","value","length","_hoisted_3","_Fragment","_renderList","removeNameArr","id","name","i","key","_hoisted_4","$data","checkedList","$event","label","_hoisted_6","_hoisted_7","_hoisted_8","checkAll","_hoisted_9","props","Array","default","String","required","close","Function","doneLocation","Object","data","computed","mapState","mapGetters","out","this","forEach","crd","HCI","VM","volumes","spec","template","filter","volume","persistentVolumeClaim","map","remaining","toRemove","count","watch","handler","neu","keys","values","unshift","deep","immediate","methods","remove","goTo","Promise","all","resource","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","_results","isEmpty","currentRouter","push","catch","err","$emit","__exports__","render"],"sourceRoot":""}